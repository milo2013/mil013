verus04,71,106,5	script	Charleston Enchant#2	10053,{
	cutin "dalle01.bmp",2;

	mes "[Charleston Mass Production]";
	mes "We are upgrading our Charleston factory products. If you have any related items, please let me know.";
	next;
	switch(select("I'd like to hear more about it.","Give the product a Enchantment","Initial Strength"))
	{
		case 1:
			mes "[Charleston Mass Production]";
			mes "I am charge 100,000 Zeny and 1 Charleston Part for 1 Reinforcement, or Initialization.";
			next;
			mes "[Charleston Mass Production]";
			mes "For reference, if you bring your equipment up to ^ff0000 + 9 refine ^000000, you will be able to choose a greater hidden power.";
			next;
			mes "[Charleston Mass Production]";
			mes "And one more thing, I know how to refrain from destroying and damaging your cards when you give them power, so you can rest assured.";
			close2;
			cutin "",255;
			end;
		case 2:
			mes "[Charleston Mass Production]";
			mes "Before upgrading, please equip your equipment in advance and select it.";
			next;
			switch(select("I'll wear the equipment.","Shoes","Armor","Garment","Accessory")){
				case 1:
					mes "[Charleston Mass Production]";
					mes "Please come back once you have installed the equipment.";
					close2;
					cutin "",255;
					end;
				case 2:
					cutin "",255;
					goto LShoesEnchant;	
					
				case 3:
					cutin "",255;
					goto LArmorEnchant;
					
				case 4:
					cutin "",255;
					goto LGarmentEnchant;
					
					
				case 5:
				    cutin "",255;
					goto LAccecoryEnchant;
					
					
			}
		case 3:
			mes "[Charleston Mass Production]";
			mes "Please select the product you want to Initialization.";
			next;
			switch(select("Shoes","Armor","Garment","Accessory","^FF0000Cancel ^000000"))
			{
				case 1:
					cutin "",255;
					if (getequipid(EQI_SHOES) == 22044) {
						set .@equip_id,22044; // Upgrade Part - Booster [1]
						set .@part, EQI_SHOES;
						goto LResetMenu;

					}
					
					if (getequipid(EQI_SHOES) == 22044) {
						set .@equip_id,22043; // Supplement Part Agi [1]
						set .@part, EQI_SHOES;
						goto LResetMenu;

					}
					
				case 2:
					cutin "",255;
					if (getequipid(EQI_ARMOR) == 15111) {
						set .@equip_id,15111; // Upgrade Part - Plate
						set .@part, EQI_ARMOR;
						goto LResetMenu;

					}
					
					if (getequipid(EQI_ARMOR) == 15110) {
						set .@equip_id,15110; // Supplement Part Str
						set .@part, EQI_ARMOR;
						goto LResetMenu;

					}
				case 3:
					cutin "",255;
					
					if (getequipid(EQI_GARMENT) == 20733) {
						set .@equip_id,20733; // Upgrade Part - Engine [1]
						set .@part, EQI_GARMENT;
						goto LResetMenu;

					}
					
					if (getequipid(EQI_GARMENT) == 20732) {
						set .@equip_id,20732; // Supplement Part Con [1]
						set .@part, EQI_GARMENT;
						goto LResetMenu;
						
					}
				
				case 4:
					cutin "",255;
					goto LAccecoryReset;
					
				case 5:
					mes "[Charleston Mass Production]";
					mes "Please come back once you have equipped the equipment.";
					close2;
					cutin "",255;
					end;
			}
	}
	
	
	// Garment Enchant
	LGarmentEnchant:
	if (getequipid(EQI_GARMENT) == 20733) {
		set .@equip_id,20733; // Upgrade Part - Engine [1]
		set .@part, EQI_GARMENT;
		}
					
	if (getequipid(EQI_GARMENT) == 20732) {
		set .@equip_id,20732; // Supplement Part Con [1]
		set .@part, EQI_GARMENT;
		}
 	
if (getequipisequiped(.@part) == 0) {
		mes "[Charleston Mass Production]";
		mes "You will have to equip all items before to start enchanment!";
		close;
	}
	if (Zeny < 100000) {  //custom translation
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Zeny!";
		next;
		mes "[Charleston Mass Production]";
		mes "Our charge is very low, so please bear with me.";
		close;
	}
	if (countitem (6752) < 10){
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Charleson Parts!";
		next;
		mes "[Charleston Mass Production]";
		mes "Please come again when you have enough Charleson Parts.";
		close;
	}
	if (getequipid(.@part) != .@equip_id) {
		mes "[Charleston Mass Production]";
		mes "I don't think this is the equipment you requested.";
		next;
		mes "[Charleston Mass Production]";
		mes "I cannot work on equipment other than those from my list.";
		close;
	}
	
	set .@equip_refine, getequiprefinerycnt(.@part);
	setarray .@equip_card[0], getequipcardid(.@part,0),getequipcardid(.@part,1),getequipcardid(.@part,2),getequipcardid(.@part,3);

	// Enchantment
	     if (.@equip_refine <= 8)  set .@ko_type01,1;
	else                           set .@ko_type01,2;

	//custom translations
		if (.@equip_card[3] >= 4700) { // Armor Enchant System
		
			if (.@equip_card[1] >= 4700) {
				mes "[Charleston Mass Production]";
				mes "This equipment cannot be further enchanted.";
				next;
				mes "[Charleston Mass Production]";
				mes "If you are not satisfied with the enchantments, I suggest that you reset the enchanment.";
				close;
			} 
			
			else if (.@equip_card[2] >= 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "The third slot has already been enchanted. Shall I enchant the second slot as well?";
				next;
				switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the second slot.";
						next;
						set .@ko_type02,3;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
			}
			
			else {
				mes "[Charleston Mass Production]";
				mes "The fourth slot has already been enchanted. Shall I enchant the third slot as well?";
				next;
				switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the third slot.";
						next;
						set .@ko_type02,2;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
			}
	} else {
		mes "[Charleston Mass Production]";
		mes "This equipment is not currently enchanted. Shall I enchant the fourth slot?";
		next;
		switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the fourth slot.";
						next;
						set .@ko_type02,1;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
	}
	
	if (.@ko_type02 == 1) {  // slot 4
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 50) 			set .@d_socket04,4731; //Agility2 
			else if (.@r <= 200) 	set .@d_socket04,4730; //Agility1
			else if (.@r <= 300) 	set .@d_socket04,4750; //Luck1
			else if (.@r <= 400) 	set .@d_socket04,4751; //Luck2
		    else if (.@r <= 500) 	set .@d_socket04,4700; //Strength1
			else if (.@r <= 600) 	set .@d_socket04,4701; //Strength2 			
			else if (.@r <= 750) 	set .@d_socket04,4740; //Vitality1
			else if (.@r <= 800) 	set .@d_socket04,4741; //Vitality2 	
			else if (.@r <= 850) 	set .@d_socket04,4720; //Dexterity1 	
			else if (.@r <= 900) 	set .@d_socket04,4721; //Dexterity2
			else if (.@r <= 950) 	set .@d_socket04,4832; //Expert_Archer1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket04;
			break;
		case 2:
			if (.@r <= 50) 			set .@d_socket04,4731; //Agility2 
			else if (.@r <= 200) 	set .@d_socket04,4730; //Agility1
			else if (.@r <= 300) 	set .@d_socket04,4750; //Luck1
			else if (.@r <= 400) 	set .@d_socket04,4751; //Luck2
		    else if (.@r <= 500) 	set .@d_socket04,4700; //Strength1
			else if (.@r <= 550) 	set .@d_socket04,4701; //Strength2 			
			else if (.@r <= 600) 	set .@d_socket04,4740; //Vitality1
			else if (.@r <= 650) 	set .@d_socket04,4741; //Vitality2 	
			else if (.@r <= 600) 	set .@d_socket04,4720; //Dexterity1 	
			else if (.@r <= 700) 	set .@d_socket04,4721; //Dexterity2
			else if (.@r <= 800) 	set .@d_socket04,4832; //Expert_Archer1
			else if (.@r <= 900) 	set .@d_socket04,4833; //Expert_Archer2
			else if (.@r <= 950) 	set .@d_socket04,4834; //Expert_Archer3
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket04;
			break;
		
		}
	} else if (.@ko_type02 == 2) {  // slot 3
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 50) 			set .@d_socket03,4731; //Agility2 
			else if (.@r <= 200) 	set .@d_socket03,4730; //Agility1
			else if (.@r <= 300) 	set .@d_socket03,4750; //Luck1
			else if (.@r <= 400) 	set .@d_socket03,4751; //Luck2
		    else if (.@r <= 500) 	set .@d_socket03,4700; //Strength1
			else if (.@r <= 600) 	set .@d_socket03,4701; //Strength2 			
			else if (.@r <= 750) 	set .@d_socket03,4740; //Vitality1
			else if (.@r <= 800) 	set .@d_socket03,4741; //Vitality2 	
			else if (.@r <= 850) 	set .@d_socket03,4720; //Dexterity1 	
			else if (.@r <= 900) 	set .@d_socket03,4721; //Dexterity2
			else if (.@r <= 950) 	set .@d_socket03,4832; //Expert_Archer1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket03;
			break;
		case 2:
			if (.@r <= 50) 			set .@d_socket03,4731; //Agility2 
			else if (.@r <= 200) 	set .@d_socket03,4730; //Agility1
			else if (.@r <= 300) 	set .@d_socket03,4750; //Luck1
			else if (.@r <= 400) 	set .@d_socket03,4751; //Luck2
		    else if (.@r <= 500) 	set .@d_socket03,4700; //Strength1
			else if (.@r <= 550) 	set .@d_socket03,4701; //Strength2 			
			else if (.@r <= 600) 	set .@d_socket03,4740; //Vitality1
			else if (.@r <= 650) 	set .@d_socket03,4741; //Vitality2 	
			else if (.@r <= 600) 	set .@d_socket03,4720; //Dexterity1 	
			else if (.@r <= 700) 	set .@d_socket03,4721; //Dexterity2
			else if (.@r <= 800) 	set .@d_socket03,4832; //Expert_Archer1
			else if (.@r <= 900) 	set .@d_socket03,4833; //Expert_Archer2
			else if (.@r <= 950) 	set .@d_socket03,4834; //Expert_Archer3
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket03;
			break;
			
		}
		} else if (.@ko_type02 == 3) {  // slot 2
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 50) 			set .@d_socket02,4731; //Agility2 
			else if (.@r <= 200) 	set .@d_socket02,4730; //Agility1
			else if (.@r <= 300) 	set .@d_socket02,4750; //Luck1
			else if (.@r <= 400) 	set .@d_socket02,4751; //Luck2
		    else if (.@r <= 500) 	set .@d_socket02,4700; //Strength1
			else if (.@r <= 600) 	set .@d_socket02,4701; //Strength2 			
			else if (.@r <= 750) 	set .@d_socket02,4740; //Vitality1
			else if (.@r <= 800) 	set .@d_socket02,4741; //Vitality2 	
			else if (.@r <= 850) 	set .@d_socket02,4720; //Dexterity1 	
			else if (.@r <= 900) 	set .@d_socket02,4721; //Dexterity2
			else if (.@r <= 950) 	set .@d_socket02,4832; //Expert_Archer1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket02;
			break;
		case 2:
			if (.@r <= 50) 			set .@d_socket02,4731; //Agility2 
			else if (.@r <= 200) 	set .@d_socket02,4730; //Agility1
			else if (.@r <= 300) 	set .@d_socket02,4750; //Luck1
			else if (.@r <= 400) 	set .@d_socket02,4751; //Luck2
		    else if (.@r <= 500) 	set .@d_socket02,4700; //Strength1
			else if (.@r <= 550) 	set .@d_socket02,4701; //Strength2 			
			else if (.@r <= 600) 	set .@d_socket02,4740; //Vitality1
			else if (.@r <= 650) 	set .@d_socket02,4741; //Vitality2 	
			else if (.@r <= 600) 	set .@d_socket02,4720; //Dexterity1 	
			else if (.@r <= 700) 	set .@d_socket02,4721; //Dexterity2
			else if (.@r <= 800) 	set .@d_socket02,4832; //Expert_Archer1
			else if (.@r <= 900) 	set .@d_socket02,4833; //Expert_Archer2
			else if (.@r <= 950) 	set .@d_socket02,4834; //Expert_Archer3
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket02;
			break;
			
		}
	} else {
		mes "[Charleston Mass Production]";
		mes "An unknown error has occurred. Please contact customer service. *^_^*";
		close;
	}
	if (.@enchantFAILED == 1) {
			misceffect 155;
			delequip .@part;
			mes "[Charleston Mass Production]]";
			mes "Be merciful to the survivor,";
			mes "Send flowers to the dead.";
			next;
			mes "[Charleston Mass Production]]";
			mes "Help for justice,";
			mes "Elimination of evil.";
			next;
			mes "[Charleston Mass Production]]";
			mes "But the important point is... the ^44B7BC" + getitemname(.@equip_id) + "^000000 is damaged!";
			close;
		set .@enchantFAILED,0;
		
		}
		
	if (.@ko_type02 == 1) {
		set .@equip_card[2], .@equip_card[3];
		set .@equip_card[3], .@enchant;
	} else if (.@ko_type02 == 2) { 
		set .@equip_card[2], .@enchant;
	} else
		set .@equip_card[1], .@enchant;
	progressbar "ffff00",2;
	set Zeny, Zeny - 100000;
	delequip .@part;
	delitem 6752,10;

//	GetNonSlotItemSock2 .@equip_refine .@equip_id .@equip_card[0] .@equip_card[1] .@equip_card[2] .@equip_card[3]
	getitem2 .@equip_id,1,1,.@equip_refine,0,.@equip_card[0],.@equip_card[1],.@equip_card[2],.@equip_card[3];

	mes "[Charleston Mass Production]";
	mes "^44B7BC" + getitemname(.@equip_id) + "^000000";
	mes "The equipment has been enchanted."; //custom translation
	close;
	end;
	
	
	// Armor Enchant
	LArmorEnchant:
	if (getequipid(EQI_ARMOR) == 15111) {
		set .@equip_id,15111; // Upgrade Part - Plate
		set .@part, EQI_ARMOR;
	}
					
	if (getequipid(EQI_ARMOR) == 15110) {
		set .@equip_id,15110; // Supplement Part Str
		set .@part, EQI_ARMOR;
	}
 	
if (getequipisequiped(.@part) == 0) {
		mes "[Charleston Mass Production]";
		mes "You will have to equip all items before to start enchanment!";
		close;
	}
	if (Zeny < 100000) {  //custom translation
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Zeny!";
		next;
		mes "[Charleston Mass Production]";
		mes "Our charge is very low, so please bear with me.";
		close;
	}
	if (countitem (6752) < 10){
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Charleson Parts!";
		next;
		mes "[Charleston Mass Production]";
		mes "Please come again when you have enough Charleson Parts.";
		close;
	}
	if (getequipid(.@part) != .@equip_id) {
		mes "[Charleston Mass Production]";
		mes "I don't think this is the equipment you requested.";
		next;
		mes "[Charleston Mass Production]";
		mes "I cannot work on equipment other than those from my list.";
		close;
	}
	
	set .@equip_refine, getequiprefinerycnt(.@part);
	setarray .@equip_card[0], getequipcardid(.@part,0),getequipcardid(.@part,1),getequipcardid(.@part,2),getequipcardid(.@part,3);

	// Enchantment
	     if (.@equip_refine <= 8)  set .@ko_type01,1;
	else                           set .@ko_type01,2;

	//custom translations
		if (.@equip_card[3] >= 4700) { // Armor Enchant System
		
			if (.@equip_card[1] >= 4700) {
				mes "[Charleston Mass Production]";
				mes "This equipment cannot be further enchanted.";
				next;
				mes "[Charleston Mass Production]";
				mes "If you are not satisfied with the enchantments, I suggest that you reset the enchanment.";
				close;
			} 
			
			else if (.@equip_card[2] >= 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "The third slot has already been enchanted. Shall I enchant the second slot as well?";
				next;
				switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the second slot.";
						next;
						set .@ko_type02,3;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
			}
			
			else {
				mes "[Charleston Mass Production]";
				mes "The fourth slot has already been enchanted. Shall I enchant the third slot as well?";
				next;
				switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the third slot.";
						next;
						set .@ko_type02,2;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
			}
	} else {
		mes "[Charleston Mass Production]";
		mes "This equipment is not currently enchanted. Shall I enchant the fourth slot?";
		next;
		
		switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the fourth slot.";
						next;
						set .@ko_type02,1;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
		}
	}
	
	if (.@ko_type02 == 1) {  // slot 4
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 50) 			set .@d_socket04,4731; //Agility2 
			else if (.@r <= 150) 	set .@d_socket04,4730; //Agility1
			else if (.@r <= 250) 	set .@d_socket04,4750; //Luck1
			else if (.@r <= 350) 	set .@d_socket04,4751; //Luck2
			else if (.@r <= 450) 	set .@d_socket04,4869; //DelayafterAttack1Lv 
			else if (.@r <= 550) 	set .@d_socket04,4872; //DelayafterAttack2Lv
			else if (.@r <= 650) 	set .@d_socket04,4859; //Evasion1	
			else if (.@r <= 750) 	set .@d_socket04,4860; //Evasion3	
			else if (.@r <= 850) 	set .@d_socket04,4762; //FLEE+6	
			else if (.@r <= 950) 	set .@d_socket04,4763; //FLEE+12	
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket04;
			break;
		case 2:
			if (.@r <= 50) 			set .@d_socket04,4731; //Agility2 
			else if (.@r <= 150) 	set .@d_socket04,4730; //Agility1
			else if (.@r <= 250) 	set .@d_socket04,4750; //Luck1
			else if (.@r <= 350) 	set .@d_socket04,4751; //Luck2
			else if (.@r <= 450) 	set .@d_socket04,4869; //DelayafterAttack1Lv 
			else if (.@r <= 459) 	set .@d_socket04,4872; //DelayafterAttack2Lv
			else if (.@r <= 500) 	set .@d_socket04,4859; //Evasion1	
			else if (.@r <= 550) 	set .@d_socket04,4860; //Evasion3	
			else if (.@r <= 600) 	set .@d_socket04,4762; //FLEE+6	
			else if (.@r <= 650) 	set .@d_socket04,4763; //FLEE+12
			else if (.@r <= 700) 	set .@d_socket04,4811; //Fighting Spirit1
			else if (.@r <= 750) 	set .@d_socket04,4810; //Fighting Spirit2
			else if (.@r <= 800) 	set .@d_socket04,4809; //Fighting Spirit3
			else if (.@r <= 850) 	set .@d_socket04,4832; //Expert Archer1
			else if (.@r <= 900) 	set .@d_socket04,4833; //Expert Archer2
			else if (.@r <= 950) 	set .@d_socket04,4834; //Expert Archer3
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket04;
			break;
		
		}
	} else if (.@ko_type02 == 2) {  // slot 3
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 50) 			set .@d_socket03,4731; //Agility2 
			else if (.@r <= 150) 	set .@d_socket03,4730; //Agility1
			else if (.@r <= 250) 	set .@d_socket03,4750; //Luck1
			else if (.@r <= 350) 	set .@d_socket03,4751; //Luck2
			else if (.@r <= 450) 	set .@d_socket03,4869; //DelayafterAttack1Lv 
			else if (.@r <= 550) 	set .@d_socket03,4872; //DelayafterAttack2Lv
			else if (.@r <= 650) 	set .@d_socket03,4859; //Evasion1	
			else if (.@r <= 750) 	set .@d_socket03,4860; //Evasion3	
			else if (.@r <= 850) 	set .@d_socket03,4762; //FLEE+6	
			else if (.@r <= 950) 	set .@d_socket03,4763; //FLEE+12	
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket03;
			break;
		case 2:
			if (.@r <= 50) 			set .@d_socket03,4731; //Agility2 
			else if (.@r <= 150) 	set .@d_socket03,4730; //Agility1
			else if (.@r <= 250) 	set .@d_socket03,4750; //Luck1
			else if (.@r <= 350) 	set .@d_socket03,4751; //Luck2
			else if (.@r <= 450) 	set .@d_socket03,4869; //DelayafterAttack1Lv 
			else if (.@r <= 459) 	set .@d_socket03,4872; //DelayafterAttack2Lv
			else if (.@r <= 500) 	set .@d_socket03,4859; //Evasion1	
			else if (.@r <= 550) 	set .@d_socket03,4860; //Evasion3	
			else if (.@r <= 600) 	set .@d_socket03,4762; //FLEE+6	
			else if (.@r <= 650) 	set .@d_socket03,4763; //FLEE+12
			else if (.@r <= 700) 	set .@d_socket03,4811; //Fighting Spirit1
			else if (.@r <= 750) 	set .@d_socket03,4810; //Fighting Spirit2
			else if (.@r <= 800) 	set .@d_socket03,4809; //Fighting Spirit3
			else if (.@r <= 850) 	set .@d_socket03,4832; //Expert Archer1
			else if (.@r <= 900) 	set .@d_socket03,4833; //Expert Archer2
			else if (.@r <= 950) 	set .@d_socket03,4834; //Expert Archer3
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket03;
			break;
			
		}
		} else if (.@ko_type02 == 3) {  // slot 2
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 50) 			set .@d_socket02,4731; //Agility2 
			else if (.@r <= 150) 	set .@d_socket02,4730; //Agility1
			else if (.@r <= 250) 	set .@d_socket02,4750; //Luck1
			else if (.@r <= 350) 	set .@d_socket02,4751; //Luck2
			else if (.@r <= 450) 	set .@d_socket02,4869; //DelayafterAttack1Lv 
			else if (.@r <= 550) 	set .@d_socket02,4872; //DelayafterAttack2Lv
			else if (.@r <= 650) 	set .@d_socket02,4859; //Evasion1	
			else if (.@r <= 750) 	set .@d_socket02,4860; //Evasion3	
			else if (.@r <= 850) 	set .@d_socket02,4762; //FLEE+6	
			else if (.@r <= 950) 	set .@d_socket02,4763; //FLEE+12	
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket02;
			break;
		case 2:
			if (.@r <= 50) 			set .@d_socket02,4731; //Agility2 
			else if (.@r <= 150) 	set .@d_socket02,4730; //Agility1
			else if (.@r <= 250) 	set .@d_socket02,4750; //Luck1
			else if (.@r <= 350) 	set .@d_socket02,4751; //Luck2
			else if (.@r <= 450) 	set .@d_socket02,4869; //DelayafterAttack1Lv 
			else if (.@r <= 459) 	set .@d_socket02,4872; //DelayafterAttack2Lv
			else if (.@r <= 500) 	set .@d_socket02,4859; //Evasion1	
			else if (.@r <= 550) 	set .@d_socket02,4860; //Evasion3	
			else if (.@r <= 600) 	set .@d_socket02,4762; //FLEE+6	
			else if (.@r <= 650) 	set .@d_socket02,4763; //FLEE+12
			else if (.@r <= 700) 	set .@d_socket02,4811; //Fighting Spirit1
			else if (.@r <= 750) 	set .@d_socket02,4810; //Fighting Spirit2
			else if (.@r <= 800) 	set .@d_socket02,4809; //Fighting Spirit3
			else if (.@r <= 850) 	set .@d_socket02,4832; //Expert Archer1
			else if (.@r <= 900) 	set .@d_socket02,4833; //Expert Archer2
			else if (.@r <= 950) 	set .@d_socket02,4834; //Expert Archer3
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket02;
			break;
			
		}
	} else {
		mes "[Charleston Mass Production]";
		mes "An unknown error has occurred. Please contact customer service. *^_^*";
		close;
	}
	if (.@enchantFAILED == 1) {
			misceffect 155;
			delequip .@part;
			mes "[Charleston Mass Production]]";
			mes "Be merciful to the survivor,";
			mes "Send flowers to the dead.";
			next;
			mes "[Charleston Mass Production]]";
			mes "Help for justice,";
			mes "Elimination of evil.";
			next;
			mes "[Charleston Mass Production]]";
			mes "But the important point is... the ^44B7BC" + getitemname(.@equip_id) + "^000000 is damaged!";
			close;
		set .@enchantFAILED,0;
		}
		
	if (.@ko_type02 == 1) {
		set .@equip_card[2], .@equip_card[3];
		set .@equip_card[3], .@enchant;
	} else if (.@ko_type02 == 2) { 
		set .@equip_card[2], .@enchant;
	} else
		set .@equip_card[1], .@enchant;
	progressbar "ffff00",2;
	set Zeny, Zeny - 100000;
	delequip .@part;
	delitem 6752,10;

//	GetNonSlotItemSock2 .@equip_refine .@equip_id .@equip_card[0] .@equip_card[1] .@equip_card[2] .@equip_card[3]
	getitem2 .@equip_id,1,1,.@equip_refine,0,.@equip_card[0],.@equip_card[1],.@equip_card[2],.@equip_card[3];

	mes "[Charleston Mass Production]";
	mes "^44B7BC" + getitemname(.@equip_id) + "^000000";
	mes "The equipment has been enchanted."; //custom translation
	close;
	end;
	
	
	
	
	//Shoes Enchant
	LShoesEnchant:
	
	if (getequipid(EQI_SHOES) == 22044) {
		set .@equip_id,22044; // Upgrade Part - Booster [1]
		set .@part, EQI_SHOES;
		}
					
	if (getequipid(EQI_SHOES) == 22043) {
		set .@equip_id,22043; // Supplement Part Agi [1]
		set .@part, EQI_SHOES;
		goto LResetMenu;
		}
 	
if (getequipisequiped(.@part) == 0) {
		mes "[Charleston Mass Production]";
		mes "You will have to equip all items before to start enchanment!";
		close;
	}
	if (Zeny < 100000) {  //custom translation
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Zeny!";
		next;
		mes "[Charleston Mass Production]";
		mes "Our charge is very low, so please bear with me.";
		close;
	}
	if (countitem (6752) < 10){
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Charleson Parts!";
		next;
		mes "[Charleston Mass Production]";
		mes "Please come again when you have enough Charleson Parts.";
		close;
	}
	if (getequipid(.@part) != .@equip_id) {
		mes "[Charleston Mass Production]";
		mes "I don't think this is the equipment you requested.";
		next;
		mes "[Charleston Mass Production]";
		mes "I cannot work on equipment other than those from my list.";
		close;
	}
	
	set .@equip_refine, getequiprefinerycnt(.@part);
	setarray .@equip_card[0], getequipcardid(.@part,0),getequipcardid(.@part,1),getequipcardid(.@part,2),getequipcardid(.@part,3);

	// Enchantment
	     if (.@equip_refine <= 8)  set .@ko_type01,1;
	else                           set .@ko_type01,2;

	//custom translations
		if (.@equip_card[3] >= 4700) { // Armor Enchant System
		
			if (.@equip_card[1] >= 4700) {
				mes "[Charleston Mass Production]";
				mes "This equipment cannot be further enchanted.";
				next;
				mes "[Charleston Mass Production]";
				mes "If you are not satisfied with the enchantments, I suggest that you reset the enchanment.";
				close;
			} 
			
			else if (.@equip_card[2] >= 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "The third slot has already been enchanted. Shall I enchant the second slot as well?";
				next;
				switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the second slot.";
						next;
						set .@ko_type02,3;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
			}
			
			else {
				mes "[Charleston Mass Production]";
				mes "The fourth slot has already been enchanted. Shall I enchant the third slot as well?";
				next;
				switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the third slot.";
						next;
						set .@ko_type02,2;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
			}
	} else {
		mes "[Charleston Mass Production]";
		mes "This equipment is not currently enchanted. Shall I enchant the fourth slot?";
		next;
				switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the fourth slot.";
						next;
						set .@ko_type02,1;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
			}
	
	if (.@ko_type02 == 1) {  // slot 4
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 200) 		set .@d_socket04,4700; //Strength1
			else if (.@r <= 300) 	set .@d_socket04,4730; //Agility1
			else if (.@r <= 400) 	set .@d_socket04,4740; //Vitality1
			else if (.@r <= 500) 	set .@d_socket04,4750; //Luck1
			else if (.@r <= 600) 	set .@d_socket04,4751; //Luck2
			else if (.@r <= 700) 	set .@d_socket04,4815; //Spell1
			else if (.@r <= 800) 	set .@d_socket04,4869; //DelayafterAttack1Lv
			else if (.@r <= 950)	set .@d_socket04,4720; //Dexterity1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket04;
			break;
		case 2:
			if (.@r <= 200) 		set .@d_socket04,4700; //Strength1
			else if (.@r <= 300) 	set .@d_socket04,4730; //Agility1
			else if (.@r <= 400) 	set .@d_socket04,4740; //Vitality1
			else if (.@r <= 500) 	set .@d_socket04,4750; //Luck1
			else if (.@r <= 600) 	set .@d_socket04,4751; //Luck2
			else if (.@r <= 700) 	set .@d_socket04,4815; //Spell1
			else if (.@r <= 800) 	set .@d_socket04,4814; //Spell2
			else if (.@r <= 900) 	set .@d_socket04,4869; //DelayafterAttack1Lv
			else if (.@r <= 950) 	set .@d_socket04,4872; //DelayafterAttack2Lv 
			else if (.@r <= 950) 	set .@d_socket04,4720; //Dexterity1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket04;
			break;
		
		}
	} else if (.@ko_type02 == 2) {  // slot 3
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 200) 		set .@d_socket03,4700; //Strength1
			else if (.@r <= 300) 	set .@d_socket03,4730; //Agility1
			else if (.@r <= 400) 	set .@d_socket03,4740; //Vitality1
			else if (.@r <= 500) 	set .@d_socket03,4750; //Luck1
			else if (.@r <= 600) 	set .@d_socket03,4751; //Luck2
			else if (.@r <= 700) 	set .@d_socket03,4815; //Spell1
			else if (.@r <= 800) 	set .@d_socket03,4869; //DelayafterAttack1Lv
			else if (.@r <= 950) 	set .@d_socket03,4720; //Dexterity1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket03;
			break;
		case 2:
			if (.@r <= 200) 		set .@d_socket03,4700; //Strength1
			else if (.@r <= 300) 	set .@d_socket03,4730; //Agility1
			else if (.@r <= 400) 	set .@d_socket03,4740; //Vitality1
			else if (.@r <= 500) 	set .@d_socket03,4750; //Luck1
			else if (.@r <= 600) 	set .@d_socket03,4751; //Luck2
			else if (.@r <= 700) 	set .@d_socket03,4815; //Spell1
			else if (.@r <= 800) 	set .@d_socket03,4814; //Spell2
			else if (.@r <= 900) 	set .@d_socket03,4869; //DelayafterAttack1Lv
			else if (.@r <= 950) 	set .@d_socket03,4872; //DelayafterAttack2Lv 
			else if (.@r <= 950) 	set .@d_socket03,4720; //Dexterity1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket03;
			break;
			
		}
		} else if (.@ko_type02 == 3) {  // slot 2
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 200) 		set .@d_socket02,4700; //Strength1
			else if (.@r <= 300) 	set .@d_socket02,4730; //Agility1
			else if (.@r <= 400) 	set .@d_socket02,4740; //Vitality1
			else if (.@r <= 500) 	set .@d_socket02,4750; //Luck1
			else if (.@r <= 600) 	set .@d_socket02,4751; //Luck2
			else if (.@r <= 700) 	set .@d_socket02,4815; //Spell1
			else if (.@r <= 800) 	set .@d_socket02,4869; //DelayafterAttack1Lv
			else if (.@r <= 950) 	set .@d_socket02,4720; //Dexterity1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket02;
			break;
			
		case 2:
			if (.@r <= 200) 		set .@d_socket02,4700; //Strength1
			else if (.@r <= 300) 	set .@d_socket02,4730; //Agility1
			else if (.@r <= 400) 	set .@d_socket02,4740; //Vitality1
			else if (.@r <= 500) 	set .@d_socket02,4750; //Luck1
			else if (.@r <= 600) 	set .@d_socket02,4751; //Luck2
			else if (.@r <= 700) 	set .@d_socket02,4815; //Spell1
			else if (.@r <= 800) 	set .@d_socket02,4814; //Spell2
			else if (.@r <= 900) 	set .@d_socket02,4869; //DelayafterAttack1Lv
			else if (.@r <= 950) 	set .@d_socket02,4872; //DelayafterAttack2Lv 
			else if (.@r <= 950) 	set .@d_socket02,4720; //Dexterity1
			else set .@enchantFAILED,1;
			
			set .@enchant, .@d_socket02;
			break;
			
		}
	} else {
		mes "[Charleston Mass Production]";
		mes "An unknown error has occurred. Please contact customer service. *^_^*";
		close;
	}
	if (.@enchantFAILED == 1) {
			misceffect 155;
			delequip .@part;
			mes "[Charleston Mass Production]]";
			mes "Be merciful to the survivor,";
			mes "Send flowers to the dead.";
			next;
			mes "[Charleston Mass Production]]";
			mes "Help for justice,";
			mes "Elimination of evil.";
			next;
			mes "[Charleston Mass Production]]";
			mes "But the important point is... the ^44B7BC" + getitemname(.@equip_id) + "^000000 is damaged!";
			close;
		set .@enchantFAILED,0;
		}
		
	if (.@ko_type02 == 1) {
		set .@equip_card[2], .@equip_card[3];
		set .@equip_card[3], .@enchant;
	} else if (.@ko_type02 == 2) { 
		set .@equip_card[2], .@enchant;
	} else
		set .@equip_card[1], .@enchant;
	progressbar "ffff00",2;
	set Zeny, Zeny - 100000;
	delequip .@part;
	delitem 6752,10;

//	GetNonSlotItemSock2 .@equip_refine .@equip_id .@equip_card[0] .@equip_card[1] .@equip_card[2] .@equip_card[3]
	getitem2 .@equip_id,1,1,.@equip_refine,0,.@equip_card[0],.@equip_card[1],.@equip_card[2],.@equip_card[3];

	mes "[Charleston Mass Production]";
	mes "^44B7BC" + getitemname(.@equip_id) + "^000000";
	mes "The equipment has been enchanted."; //custom translation
	close;
	end;
	
	
	// Reset Enchant
	LResetMenu:
	mes "[Charleston Mass Production]";
		mes "You want to reset ^44B7BC" + getitemname(.@equip_id) + "^000000?";
		next;
		mes "[Charleston Mass Production]";
		mes "The cost is the same but I do provide a service to remove any slot of enchant. Are you interested?";
		next;
		switch(select("Reset all.:Reset only the 4th Slot.:Reset only the 3rd Slot.:Reset only the 2nd Slot.")) {
		case 1:
			mes "[Charleston Mass Production]";
			mes "Very well. I will reset all slots.";
			next;
			set .@sot99_ck,1;
			break;
		case 2:
			mes "[Charleston Mass Production]";
			mes "Very well. I will reset only your 4th slot.";
			next;
			set .@sot04_ck,1;
			break;
		case 3:
			mes "[Charleston Mass Production]";
			mes "Very well. I will reset only your 3rd slot.";
			next;
			set .@sot03_ck,1;
			break;
		case 4:
			mes "[Charleston Mass Production]";
			mes "Very well. I will reset only your 2nd slot.";
			next;
			set .@sot02_ck,1;
			break;
		}
	set .@select,2;

	if (getequipisequiped(.@part) == 0) {
		mes "[Charleston Mass Production]";
		mes "You will have to equip all items before you start RESET!";
		close;
	}
	if (Zeny < 100000) {  //custom translation
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Zeny!";
		next;
		mes "[Charleston Mass Production]";
		mes "Our charge is very low, so please bear with me.";
		close;
	}
	if (countitem (6752) < 10){
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough ^FF0000 Charleston Parts^000000!";
		close;
	}
	if (getequipid(.@part) != .@equip_id) {
		mes "[Charleston Mass Production]";
		mes "I don't think this is the equipment you requested.";
		next;
		mes "[Charleston Mass Production]";
		mes "I cannot work on equipment other than those from my list.";
		close;
	}

	set .@equip_refine, getequiprefinerycnt(.@part);
	setarray .@equip_card[0], getequipcardid(.@part,0),getequipcardid(.@part,1),getequipcardid(.@part,2),getequipcardid(.@part,3);

	// Initialization
	if (.@select == 2) {
		if (.@sot04_ck) {
			if (.@equip_card[3] < 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "The forth slot is is not enchanted. Please check again."; //custom translation
				close;
			}
			set .@equip_card[3],0;
			
		}	
		if (.@sot03_ck) {
			if (.@equip_card[2] < 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "The third slot is is not enchanted. Please check again."; //custom translation
				close;
			}
			set .@equip_card[2],0;
			
		}	
		if (.@sot02_ck) {
			if (.@equip_card[1] < 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "The second slot is is not enchanted. Please check again."; //custom translation
				close;
			}
			set .@equip_card[1],0;
		
			
		} 
		if (.@sot99_ck) {
			if (.@equip_card[3] < 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "This equipment is is not enchanted. Please check again."; //custom translation
				close;
			}
			set .@equip_card[1],0;
			set .@equip_card[2],0;
			set .@equip_card[3],0;
			
		}
		progressbar "ffff00",2;
		set Zeny, Zeny - 100000;
		delitem 6752,10;
		delequip .@part;

//		GetNonSlotItemSock2 .@equip_refine .@equip_id .@equip_card[0] .@equip_card[1] .@equip_card[2] .@equip_card[3]
		getitem2 .@equip_id,1,1,.@equip_refine,0,.@equip_card[0],.@equip_card[1],.@equip_card[2],.@equip_card[3];

		mes "[Charleston Mass Production]";
		mes "Initialization complete.";
		close;
	}
	end;
	
	
	
	
	
	LAccecoryReset:
	
	mes "[Charleston Mass Production]";
		mes "Which part do you want to ^FF0000RESET^000000?";
		next;
			switch(select("Right Accessory - " + getitemname(getequipid(EQI_ACC_R)) + "","Left Accessory - " + getitemname(getequipid(EQI_ACC_L)) + "","^FF0000Cancel ^000000")){
				case 1:
				if (getequipid(EQI_ACC_R) == 2995) {
					set .@equip_id,2995; // Supplement Part Dex [1]
					set .@part, EQI_ACC_R;
					break;
					}
				
				if (getequipid(EQI_ACC_R) == 2996) {
					set .@equip_id,2996; // Upgrade Part - Gun Barrel [1]
					set .@part, EQI_ACC_R;
					break;
					}
				
				case 2:
				if (getequipid(EQI_ACC_L) == 2996) {
					set .@equip_id,2996; // Upgrade Part - Gun Barrel [1]
					set .@part, EQI_ACC_L;
					break;
					}
					
				if (getequipid(EQI_ACC_L) == 2995) {
					set .@equip_id,2995; // Supplement Part Dex [1]
					set .@part, EQI_ACC_L;
					break;
					}
					
				case 3:
				close;
				end;		
			}	
			
		mes "[Charleston Mass Production]";
		mes "You want to reset ^44B7BC" + getitemname(.@equip_id) + "^000000?";
		next;
		mes "[Charleston Mass Production]";
		mes "The cost is the same but I do provide a service to remove any enchant to 3rd slot only or 4 slot only. Are you interested?";
		next;
		switch(select("Reset all.:Reset only the 4th Slot.:Reset only the 3rd Slot.")) {
		case 1:
			mes "[Charleston Mass Production]";
			mes "Very well. I will reset all slots.";
			next;
			set .@sot99_ck,1;
			break;
		case 2:
			mes "[Charleston Mass Production]";
			mes "Very well. I will reset only your 4th slot.";
			next;
			set .@sot04_ck,1;
			break;
		case 3:
			mes "[Charleston Mass Production]";
			mes "Very well. I will reset only your 3rd slot.";
			next;
			set .@sot03_ck,1;
			break;
		}
	set .@select,2;

	if (getequipisequiped(.@part) == 0) {
		mes "[Charleston Mass Production]";
		mes "You will have to equip all items before you start RESET!";
		close;
	}
	if (Zeny < 100000) {  //custom translation
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Zeny!";
		next;
		mes "[Charleston Mass Production]";
		mes "Our charge is very low, so please bear with me.";
		close;
	}
	if (countitem (6752) < 10){
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough ^FF0000 Charleston Parts^000000!";
		close;
	}
	if (getequipid(.@part) != .@equip_id) {
		mes "[Charleston Mass Production]";
		mes "I don't think this is the equipment you requested.";
		next;
		mes "[Charleston Mass Production]";
		mes "I cannot work on equipment other than those from my list.";
		close;
	}

	set .@equip_refine, getequiprefinerycnt(.@part);
	setarray .@equip_card[0], getequipcardid(.@part,0),getequipcardid(.@part,1),getequipcardid(.@part,2),getequipcardid(.@part,3);

	// Initialization
	if (.@select == 2) {
		if (.@sot04_ck) {
			if (.@equip_card[3] < 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "The forth slot is is not enchanted. Please check again."; //custom translation
				close;
			}
			set .@equip_card[3],0;
			
		}	
		if (.@sot03_ck) {
			if (.@equip_card[2] < 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "The third slot is is not enchanted. Please check again."; //custom translation
				close;
			}
			set .@equip_card[2],0;
			
		}	 
		if (.@sot99_ck) {
			if (.@equip_card[3] < 4700) { // Armor Enchant System
				mes "[Charleston Mass Production]";
				mes "This equipment is is not enchanted. Please check again."; //custom translation
				close;
			}
			set .@equip_card[1],0;
			set .@equip_card[2],0;
			set .@equip_card[3],0;
			
		}
		progressbar "ffff00",2;
		set Zeny, Zeny - 100000;
		delitem 6752,10;
		delequip .@part;
		
//		GetNonSlotItemSock2 .@equip_refine .@equip_id .@equip_card[0] .@equip_card[1] .@equip_card[2] .@equip_card[3]
		getitem2 .@equip_id,1,1,.@equip_refine,0,.@equip_card[0],.@equip_card[1],.@equip_card[2],.@equip_card[3];

		mes "[Charleston Mass Production]";
		mes "Initialization complete.";
		close;
	}
	end;
	
	
	
	
	LAccecoryEnchant:
	
		mes "[Charleston Mass Production]";
		mes "Which part do you want to enchant?";
		next;
			switch(select("Right Accessory - " + getitemname(getequipid(EQI_ACC_R)) + "","Left Accessory - " + getitemname(getequipid(EQI_ACC_L)) + "","^FF0000Cancel ^000000")){
				case 1:
				if (getequipid(EQI_ACC_R) == 2995) {
					set .@equip_id,2995; // Supplement Part Dex [1]
					set .@part, EQI_ACC_R;
					break;
					}
				
				if (getequipid(EQI_ACC_R) == 2996) {
					set .@equip_id,2996; // Upgrade Part - Gun Barrel [1]
					set .@part, EQI_ACC_R;
					break;
					}
				
				case 2:
				if (getequipid(EQI_ACC_L) == 2996) {
					set .@equip_id,2996; // Upgrade Part - Gun Barrel [1]
					set .@part, EQI_ACC_L;
					break;
					}
					
				if (getequipid(EQI_ACC_L) == 2995) {
					set .@equip_id,2995; // Supplement Part Dex [1]
					set .@part, EQI_ACC_L;
					break;
					}
					
				case 3:
				close;
				end;		
			}	
			
	if (getequipisequiped(.@part) == 0) {
		mes "[Charleston Mass Production]]";
		mes "You will have to equip all items before you start Enchant!";
		close;
	}
	if (Zeny < 100000) {  //Zeny Check
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Zeny!";
		next;
		mes "[Charleston Mass Production]";
		mes "Our charge is very low, so please bear with me.";
		close;
	}
	if (countitem (6752) < 10){ // Charleston Parts
		mes "[Charleston Mass Production]";
		mes "I'm sorry, but you don't have enough Charleston Parts!";
		next;
		mes "[Charleston Mass Production]";
		mes "Please come again when you have enough Charleston Parts.";
		close;
	}
	if (getequipid(.@part) != .@equip_id) {
		mes "[Charleston Mass Production]";
		mes "I don't think this is the equipment you requested.";
		next;
		mes "[Charleston Mass Production]";
		mes "I cannot work on equipment other than those from my list.";
		close;
	}
	
	set .@equip_refine, getequiprefinerycnt(.@part);
	setarray .@equip_card[0], getequipcardid(.@part,0),getequipcardid(.@part,1),getequipcardid(.@part,2),getequipcardid(.@part,3);
	
	// Enchantment
	set .@ko_type01,1;
	
	//custom translations
	if (.@equip_card[3] >= 4700) { // Armor Enchant System
		if (.@equip_card[2] >= 4700) {
			mes "[Charleston Mass Production]";
			mes "This equipment cannot be further enchanted.";
			next;
			mes "[Charleston Mass Production]";
			mes "If you are not satisfied with the enchantments, I suggest that you reset the enchanment.";
			close;
		} else {
			mes "[Charleston Mass Production]";
			mes "The fourth slot has already been enchanted. Shall I enchant the third slot as well?";
			next;
			
			switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the third slot.";
						next;
						set .@ko_type02,2;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
				
		}
	} else {
		mes "[Charleston Mass Production]";
		mes "This equipment is not currently enchanted. Shall I enchant the fourth slot?";
		next;
		switch(select("Do it now","Do it later")){
					case 1:
						mes "[Charleston Mass Production]";
						mes "Starting to enchant the fourth slot.";
						next;
						set .@ko_type02,1;
						break;
				
					case 2:
						mes "[Charleston Mass Production]";
						mes "Very well. Hope to see you later.";
						close;
				}
	}

	if (.@ko_type02 == 1) {  // slot 4
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 220) set .@d_socket04,4720; //Dexterity1
				 else if (.@r <= 460) set .@d_socket04,4730; //Inteligence1
				 else if (.@r <= 510) set .@d_socket04,4740; //Vitality1
				 else if (.@r <= 630) set .@d_socket04,4750; //Luck1 
				 else if (.@r <= 880) set .@d_socket04,4751; //Luck2  
				 else if (.@r <= 950) set .@d_socket04,4815; //Spell1  
				 else if (.@r <= 950) set .@d_socket04,4869; //DelayafterAttack1Lv
				 else if (.@r <= 999) set .@d_socket04,4700; //Strength1
				 else set .@enchantFAILED,1;
				 set .@enchant, .@d_socket04;
				 break;
		}
	} else if (.@ko_type02 == 2) {  // slot 3
		set .@r, rand(1,1000);
		switch (.@ko_type01) {
		case 1:
			if (.@r <= 220) set .@d_socket03,4720; //Dexterity1
				 else if (.@r <= 460) set .@d_socket03,4730; //Inteligence1
				 else if (.@r <= 510) set .@d_socket03,4740; //Vitality1
				 else if (.@r <= 630) set .@d_socket03,4750; //Luck1 
				 else if (.@r <= 880) set .@d_socket03,4751; //Luck2  
				 else if (.@r <= 950) set .@d_socket03,4815; //Spell1  
				 else if (.@r <= 999) set .@d_socket03,4700; //Strength1
				 else set .@enchantFAILED,1;
				 set .@enchant, .@d_socket03;
				 break;		
		}
	} else {
		mes "[Charleston Mass Production]";
		mes "An unknown error has occurred. Please contact customer service. *^_^*";
		close;
	}
	
	if (.@enchantFAILED == 1) {
			misceffect 155;
			delequip .@part;
			mes "[Charleston Mass Production]]";
			mes "Be merciful to the survivor,";
			mes "Send flowers to the dead.";
			next;
			mes "[Charleston Mass Production]]";
			mes "Help for justice,";
			mes "Elimination of evil.";
			next;
			mes "[Charleston Mass Production]]";
			mes "But the important point is... the ^44B7BC" + getitemname(.@equip_id) + "^000000 is damaged!";
			close;
		set .@enchantFAILED,0;
		}
		
	if (.@ko_type02 == 1) {
		set .@equip_card[2], .@equip_card[3];
		set .@equip_card[3], .@enchant;
	} else
		set .@equip_card[2], .@enchant;
	progressbar "ffff00",2;
	set Zeny, Zeny - 100000;
	delequip .@part;
	delitem 6752,10;
	
	//	GetNonSlotItemSock2 .@equip_refine .@equip_id .@equip_card[0] .@equip_card[1] .@equip_card[2] .@equip_card[3]
	getitem2 .@equip_id,1,1,.@equip_refine,0,.@equip_card[0],.@equip_card[1],.@equip_card[2],.@equip_card[3];

	mes "[Charleston Mass Production]";
	mes "^44B7BC" + getitemname(.@equip_id) + "^000000";
	mes "The equipment has been enchanted."; //custom translation
	close;
	end;
	
	}